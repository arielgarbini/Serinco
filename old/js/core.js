window.RU=window.RU||{},window.RU.Mixin=window.RU.Mixin||{},RU.Mixin.ReCaptcha=Class(function(){var a=function(){return window.grecaptcha.getResponse().length>0||(this.onCaptchaEmpty(),!1)};return{captchaSelector:null,appendCaptcha:function(){if(Settings.reCaptcha.enabled){if(null==this.captchaSelector)throw"Set captcha selector at heritable class";var a=$(this.captchaSelector);a.attr("data-sitekey",Settings.reCaptcha.token),$.getScript("https://www.google.com/recaptcha/api.js?hl=en").done(function(){a.show()})}},isCaptchaValid:function(){return!Settings.reCaptcha.enabled||a.call(this)},onCaptchaEmpty:function(){},getCaptchaResponse:function(){if(Settings.reCaptcha.enabled&&window.grecaptcha)return window.grecaptcha.getResponse()},resetRecapcha:function(){Settings.reCaptcha.enabled&&window.grecaptcha.reset()}}}),window.RU=window.RU||{},window.RU.Common=window.RU.Common||{},RU.Common.FieldIsRequired="You need to type something here",RU.Common.SubmitPage=Class(function(){return{windowResizeHandler:$.noop,getFormValues:$.noop,processSuccess:$.noop,isFormValid:$.noop,getSubmitUrl:$.noop,submitBtn:null,loader:null,constructor:function(){$(".message").click(function(){return $(this).fadeOut(),!1});var a=this;$("input").keypress(function(b){13==b.which&&a.submitForm()}),this.bindSubmit(),$(window).resize(this.windowResizeHandler),$(window).on("load",function(){$(window).resize()})},bindSubmit:function(){this.submitBtn.on("click",this.submitForm.bind(this))},unbindSubmit:function(){this.submitBtn.unbind("click")},submitForm:function(){if(this.isFormValid()){this.unbindSubmit();var a=this.getFormValues();this.showLoader(),this.doRequest(a)}},doRequest:function(a){var b=this.buildRequest(a);$.ajax(b)},buildRequest:function(a){return{url:this.getSubmitUrl(),data:a,method:"POST",success:this.onSubmitSuccess.bind(this),error:this.onSubmitFailure.bind(this)}},onSubmitSuccess:function(a){return a.success?void this.processSuccess(a):this.processErrors(a)},onSubmitFailure:function(a){this.hideLoader(),this.bindSubmit(),this.resetRecapcha()},processErrors:function(a){this.hideLoader(),this.bindSubmit(),this.resetRecapcha()},onFieldIsEmpty:function(a){this.showValidationMessage(a,RU.Common.FieldIsRequired)},showValidationMessage:function(a,b){var c=a.parent().find(".message");c.is(":hidden")&&c.text(b).fadeIn()},hideValidationMessage:function(a){var b=a.parent().find(".message");b.is(":visible")&&b.fadeOut()},showLoader:function(){this.loader.fadeIn()},hideLoader:function(){this.loader.fadeOut()},getParameterByName:function(a,b){b||(b=window.location.href),a=a.replace(/[\[\]]/g,"\\$&");var c=new RegExp("[?&]"+a+"(=([^&#]*)|&|#|$)"),d=c.exec(b);return d?d[2]?decodeURIComponent(d[2].replace(/\+/g," ")):"":null}}}),window.RU=window.RU||{},window.RU.Common=window.RU.Common||{},RU.Common.HiddenSuccessPage=Class([RU.Common.SubmitPage],function(){return{submitBlock:null,successBlock:null,setupSuccessBehavior:$.noop,constructor:function(){this.setupSuccessBehavior(),RU.Common.HiddenSuccessPage.$super.call(this)},processSuccess:function(a){RU.Common.HiddenSuccessPage.$superp.processSuccess.call(this,a),this.toggleForms()},toggleForms:function(){this.submitBlock.toggle(),this.successBlock.toggle()},onSubmitSuccess:function(a){RU.Common.HiddenSuccessPage.$superp.onSubmitSuccess.call(this,a),$("html, body").animate({scrollTop:this.successBlock.offset().top-100},500)}}}),window.RU=window.RU||{},window.RU.Common=window.RU.Common||{},RU.Common.EmailLatinOnly="Please enter valid email address. It cannot contain non latin characters.",RU.Common.EmailTooBig="Sorry, this is too long. Please keep it under 255 characters.",RU.Common.WrongEmail="Please enter a valid email address. You can do it!",RU.Common.EmailIsNotExist="There is not such email in our catalog.",RU.Common.EmailPage=Class([RU.Common.HiddenSuccessPage,RU.Mixin.ReCaptcha],function(){var a=function(a,b){var c=a||this.emailField.val();return c&&0!=c.length?c.length>this.emailMaxLength?(b||this.onEmailIsTooBig(),!1):this.emailLetterSetReg.test(c)?!!this.emailFormatReg.test(c)||(b||this.onEmailWrongFormat(),!1):(b||this.onEmailWrongLetterSet(),!1):(b||this.onFieldIsEmpty(this.emailField),!1)};return{emailField:null,emailLetterSetReg:/^([a-zA-Z0-9_\.\-\+\@])+$/,emailFormatReg:/^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/,emailMaxLength:255,submitBlock:null,successBlock:null,captchaSelector:null,constructor:function(){this.appendCaptcha(),this.captchaSelector="#recaptcha",this.submitBlock=$("#submit"),this.successBlock=$("#success"),RU.Common.EmailPage.$super.call(this)},isEmailValid:function(b,c){return a.call(this,b,c)},onEmailWrongLetterSet:function(){this.showValidationMessage(this.emailField,RU.Common.EmailLatinOnly)},onEmailIsNotExist:function(){this.showValidationMessage(this.emailField,RU.Common.EmailIsNotExist)},onEmailWrongFormat:function(){this.showValidationMessage(this.emailField,RU.Common.WrongEmail)},onEmailIsTooBig:function(){this.showValidationMessage(this.emailField,RU.Common.EmailTooBig)},isFormValid:function(){return this.isEmailValid()&&this.isCaptchaValid()},getFormValues:function(){var a=RU.Common.EmailPage.$superp.getFormValues.call(this)||{};return a.email=this.emailField.val(),a},buildRequest:function(a){var b=RU.Common.EmailPage.$superp.buildRequest.call(this,a);return b.method="GET",b.data=null,b.headers={"g-Recaptcha-Response":this.getCaptchaResponse()},b}}});